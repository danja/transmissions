# src/apps/example-application/config.ttl

@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .

@prefix : <http://purl.org/stuff/transmissions/> . # for custom terms & instances

# ns.trn.sourceFile

:origin a :ConfigSet ;
    :sourceFile "test.md" .
   # :targetField "links" .

:listField a :ConfigSet ;
    :remove "true" ;
    :forEach "links" .

:retree a :ConfigSet ;
    :rename (:pp1) . # consider using blank nodes
    :pp1   :pre     "currentItem.url" ;
            :post    "url"  .

:normalizeURL a :ConfigSet ;
    :inputField "resource.target" ;
    :outputField "resource.target" ;
    :removeTrailingSlash "true" .

:resourceMinterSettings a :ConfigSet ;
    :targetField "resource" .

:retreeResponse a :ConfigSet ;
    :rename (:rr1 :rr2 :rr3 :rr4 :rr5 :rr6) . # consider using blank nodes
    :rr1   :pre     "currentItem.url" ;
            :post    "resource.target"  .
    :rr2   :pre     "currentItem.text" ;
            :post    "resource.title"  .
    :rr3   :pre     "http.status" ;
            :post    "resource.status"  .
    :rr4   :pre     "http.last-modified" ;
            :post    "resource.last-modified"  .
    :rr5   :pre     "http.contentType" ;
            :post    "resource.contentType"  .
    :rr6   :pre     "http.etag" ;
            :post    "resource.etag"  .

:prepareSelect a :ConfigSet ;
    :rename (:ps1) .
    :ps1   :pre     "resource.target" ;
            :post    "target"  .

:selectBookmark a :ConfigSet ;
        :templateFilename "data/select-bookmark.njk" ;
        :endpointSettings "data/endpoints.json" ;
        :graph <http://hyperdata.it/content> .

:replaceURI a :ConfigSet ;
        :testProperty "queryResults.results.bindings" ;
        :testOperator 'exists' ;
        :trueProperty "resource.uri" ;
        :trueValue "queryResults.results.bindings[0].bookmark.value" ;
        :falseProperty "resource.uri" ;
        :falseValue "resource.uri" .

:updateBookmark a :ConfigSet ;
# :loglevel "debug" ;
    :delay "100" ;
    :dataBlock "resource" ;
    :templateFilename "data/update-bookmark.njk" ;
    :noCache "true" ; # always reload endpoints
    :endpointSettings "data/endpoints.json" ;
    :graph <http://hyperdata.it/content> .